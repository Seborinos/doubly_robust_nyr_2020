"0","dr_estimator <- function(data, prop_model, mean_model) {"
"0","  data %>% "
"0","    mutate("
"0","      prob = predict(prop_model, newdata = data, type = 'response'),"
"0","      pred = predict(mean_model, newdata = data, type = 'response'),"
"0","    ) %>% "
"0","    summarise("
"0","      EY0_dr = mean((outcome*(1 - treatment) - (treatment - prob)*pred) / (1 - prob)),"
"0","      EY1_dr = mean((outcome*treatment - (treatment - prob)*pred) / prob)"
"0","    ) %>% "
"0","    mutate(dre = EY1_dr - EY0_dr)"
"0","}"
